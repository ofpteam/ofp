<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.webside.ofp.mapper.QuotationSubSheetMapper">
  <resultMap id="quotationSubSheetMap" type="com.webside.ofp.model.QuotationSubSheetEntity">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 20 23:16:43 CST 2017.
    -->
    <id column="QUOTATION_SUB_SHEET_ID" jdbcType="INTEGER" property="quotationSubSheetId" />
    <result column="PRODUCT_ID" jdbcType="INTEGER" property="productId" />
    <result column="QUOTATION_SHEET_ID" jdbcType="INTEGER" property="quotationSheetId" />
    <result column="USD_PRICE" jdbcType="DECIMAL" property="usdPrice" />
    <result column="BUY_PRICE" jdbcType="DECIMAL" property="buyPrice" />
    <result column="UNIT" jdbcType="VARCHAR" property="unit" />
    <result column="WEIGHT" jdbcType="INTEGER" property="weight" />
    <result column="VOLUME" jdbcType="INTEGER" property="volume" />
    <result column="TOP" jdbcType="DECIMAL" property="top" />
    <result column="BOTTOM" jdbcType="DECIMAL" property="bottom" />
    <result column="HEIGHT" jdbcType="DECIMAL" property="height" />
    <result column="PACKING" jdbcType="VARCHAR" property="packing" />
    <result column="PACKING_RATE" jdbcType="DECIMAL" property="packingRate" />
    <result column="NUMBER" jdbcType="INTEGER" property="number" />
    <result column="PACK_NUM" jdbcType="INTEGER" property="packNum" />
    <result column="TOTALCBM" jdbcType="DECIMAL" property="totalcbm" />
    <result column="GW" jdbcType="DECIMAL" property="gw" />
    <result column="TOTAL_GW" jdbcType="DECIMAL" property="totalGw" />
    <association property="product" column="PRODUCT_ID" javaType="com.webside.ofp.model.ProductEntityWithBLOBs">
    	<id column="PRODUCT_ID" jdbcType="INTEGER" property="productId" />
	    <result column="PRODUCT_CODE" jdbcType="VARCHAR" property="productCode" />
	    <result column="FACTORY_CODE" jdbcType="VARCHAR" property="factoryCode" />
	    <result column="UNIT" jdbcType="VARCHAR" property="unit" />
	    <result column="CUSTOMS_CODE" jdbcType="VARCHAR" property="customsCode" />
	    <result column="USD_PRICE" jdbcType="DECIMAL" property="usdPrice" />
	    <result column="CN_NAME" jdbcType="VARCHAR" property="cnName" />
	    <result column="EN_NAME" jdbcType="VARCHAR" property="enName" />
	    <result column="VAT_RATE" jdbcType="DECIMAL" property="vatRate" />
	    <result column="BUY_PRICE" jdbcType="DECIMAL" property="buyPrice" />
	    <result column="WEIGHT" jdbcType="INTEGER" property="weight" />
	    <result column="VOLUME" jdbcType="INTEGER" property="volume" />
	    <result column="TOP" jdbcType="DECIMAL" property="top" />
	    <result column="BOTTOM" jdbcType="DECIMAL" property="bottom" />
	    <result column="HEIGHT" jdbcType="DECIMAL" property="height" />
	    <result column="LENGTH" jdbcType="DECIMAL" property="length" />
	    <result column="WIDTH" jdbcType="DECIMAL" property="width" />
	    <result column="PACK_HEIGHT" jdbcType="DECIMAL" property="packHeight" />
	    <result column="GW" jdbcType="DECIMAL" property="gw" />
	    <result column="PACKING_RATE" jdbcType="DECIMAL" property="packingRate" />
	    <result column="TAX_REBATE_RATE" jdbcType="DECIMAL" property="taxRebateRate" />
	    <result column="CBM" jdbcType="DECIMAL" property="cbm" />
	    <result column="PACKING" jdbcType="VARCHAR" property="packing" />
	    <result column="HD_MAP_URL" jdbcType="VARCHAR" property="hdMapUrl" />
	    <result column="IS_DELETE" jdbcType="INTEGER" property="isDelete" />
	    <result column="CREATE_TIME" jdbcType="TIMESTAMP" property="createTime" />
	    <result column="MODIFY_TIME" jdbcType="TIMESTAMP" property="modifyTime" />
	    <result column="CREATE_USER" jdbcType="INTEGER" property="createUser" />
	    <result column="MODIFY_USER" jdbcType="INTEGER" property="modifyUser" />
	    <result column="DESCRIPTION" jdbcType="VARCHAR" property="description" />
	    <result column="THUMBNAIL" jdbcType="LONGVARBINARY" property="thumbnail" />
    	<result column="QR_CODE_PIC" jdbcType="LONGVARBINARY" property="qrCodePic" />
    </association>
  </resultMap>
  
  <sql id="quotation_sub_sheet_column_list">
    QUOTATION_SUB_SHEET_ID, PRODUCT_ID, QUOTATION_SHEET_ID, USD_PRICE, BUY_PRICE, UNIT, 
    WEIGHT, VOLUME, TOP, BOTTOM, HEIGHT, PACKING, PACKING_RATE, NUMBER, PACK_NUM, TOTALCBM, 
    GW, TOTAL_GW
  </sql>
  
 <sql id="product_column_List">
    p.PRODUCT_ID, p.PRODUCT_TYPE_ID, p.PRODUCT_CODE, p.FACTORY_CODE, p.UNIT, p.CUSTOMS_CODE, p.USD_PRICE, 
    p.CN_NAME, p.EN_NAME, p.VAT_RATE, p.BUY_PRICE, p.WEIGHT, p.VOLUME, p.TOP, p.BOTTOM, p.HEIGHT, p.LENGTH, 
    p.WIDTH, p.PACK_HEIGHT, p.GW, p.PACKING_RATE, p.TAX_REBATE_RATE, p.CBM, p.PACKING, p.HD_MAP_URL, 
    p.IS_DELETE, p.CREATE_TIME, p.MODIFY_TIME, p.CREATE_USER, p.MODIFY_USER, p.DESCRIPTION
  </sql>
  
  <select id="queryListByPage" parameterType="map" resultMap="quotationSubSheetMap"
		flushCache="true" useCache="true">
		SELECT 
		<include refid="quotation_sub_sheet_column_list" />
		from quotation_sub_sheet q
		where q.is_delete = 0 
		and q.QUOTATION_SUB_SHEET_ID >= (
			select QUOTATION_SUB_SHEET_ID from quotation_sub_sheet order by QUOTATION_SUB_SHEET_ID limit ${start},1
		)
		limit ${pageNumber}
  </select>
  
  <select id="queryListAll" parameterType="map" resultMap="quotationSubSheetMap"
		flushCache="true" useCache="true">
		SELECT 
		 <include refid="quotation_sub_sheet_column_list" />
		from quotation_sub_sheet q 
		where q.is_delete = 0 
		order by QUOTATION_SUB_SHEET_ID desc
  </select>
  
  <select id="findById" parameterType="long"  resultMap="quotationSubSheetMap" flushCache="true" useCache="true">
    select 
	<include refid="quotation_sub_sheet_column_list" />
    from quotation_sub_sheet q 
    where q.is_delete = 0 and QUOTATION_SUB_SHEET_ID = #{id,jdbcType=INTEGER}
  </select>
  
  <select id="findBySheetId" parameterType="long"  resultMap="quotationSubSheetMap" flushCache="true" useCache="true">
    select 
	<include refid="quotation_sub_sheet_column_list" />
    from quotation_sub_sheet q 
    where q.is_delete = 0 and q.QUOTATION_SHEET_ID = #{sheetId}
  </select>
  
  <delete id="deleteById" parameterType="int">
    update quotation_sub_sheet set IS_DELETE = 1 where QUOTATION_SUB_SHEET_ID = ${id}
  </delete>
  
  <delete id="deleteBySheetIdPhysical" parameterType="int">
   	delete from quotation_sub_sheet where QUOTATION_SHEET_ID = ${sheetId}
  </delete>
  
  <delete id="deleteBySheetId" parameterType="int">
    update quotation_sub_sheet set IS_DELETE = 1 where QUOTATION_SHEET_ID = ${sheetId}
  </delete>
  
  <delete id="deleteBatchById" parameterType="list">
	update quotation_sub_sheet set IS_DELETE = 1 where QUOTATION_SUB_SHEET_ID in
	<foreach collection="list" item="id" open="(" separator=","
		close=")">
		#{id}
	</foreach>
  </delete>
  
  <insert id="insertBatch" parameterType="java.util.List" useGeneratedKeys="true" keyProperty="quotationSubSheetId">
       insert into quotation_sub_sheet (PRODUCT_ID, QUOTATION_SHEET_ID, 
	      USD_PRICE, BUY_PRICE, UNIT, 
	      WEIGHT, VOLUME, TOP, 
	      BOTTOM, HEIGHT, PACKING, 
	      PACKING_RATE, NUMBER, PACK_NUM, 
	      TOTALCBM, GW, TOTAL_GW
	  	)
    	values 
    	<foreach collection="list" item="item" separator="," index="index">
	    	(#{item.productId,jdbcType=INTEGER}, #{item.quotationSheetId,jdbcType=INTEGER}, 
			      #{item.usdPrice,jdbcType=DECIMAL}, #{item.buyPrice,jdbcType=DECIMAL}, #{item.unit,jdbcType=VARCHAR}, 
			      #{item.weight,jdbcType=INTEGER}, #{item.volume,jdbcType=INTEGER}, #{item.top,jdbcType=DECIMAL}, 
			      #{item.bottom,jdbcType=DECIMAL}, #{item.height,jdbcType=DECIMAL}, #{item.packing,jdbcType=VARCHAR}, 
			      #{item.packingRate,jdbcType=DECIMAL}, #{item.number,jdbcType=INTEGER}, #{item.packNum,jdbcType=INTEGER}, 
			      #{item.totalcbm,jdbcType=DECIMAL}, #{item.gw,jdbcType=DECIMAL}, #{item.totalGw,jdbcType=DECIMAL}
	      	)
    	</foreach>
  </insert>
  
  <insert id="insert" parameterType="com.webside.ofp.model.QuotationSubSheetEntity" useGeneratedKeys="true" keyProperty="quotationSubSheetId">
    insert into quotation_sub_sheet (PRODUCT_ID, QUOTATION_SHEET_ID, 
      USD_PRICE, BUY_PRICE, UNIT, 
      WEIGHT, VOLUME, TOP, 
      BOTTOM, HEIGHT, PACKING, 
      PACKING_RATE, NUMBER, PACK_NUM, 
      TOTALCBM, GW, TOTAL_GW
      )
    values (#{productId,jdbcType=INTEGER}, #{quotationSheetId,jdbcType=INTEGER}, 
      #{usdPrice,jdbcType=DECIMAL}, #{buyPrice,jdbcType=DECIMAL}, #{unit,jdbcType=VARCHAR}, 
      #{weight,jdbcType=INTEGER}, #{volume,jdbcType=INTEGER}, #{top,jdbcType=DECIMAL}, 
      #{bottom,jdbcType=DECIMAL}, #{height,jdbcType=DECIMAL}, #{packing,jdbcType=VARCHAR}, 
      #{packingRate,jdbcType=DECIMAL}, #{number,jdbcType=INTEGER}, #{packNum,jdbcType=INTEGER}, 
      #{totalcbm,jdbcType=DECIMAL}, #{gw,jdbcType=DECIMAL}, #{totalGw,jdbcType=DECIMAL}
      )
  </insert>
  
  <update id="update" parameterType="com.webside.ofp.model.QuotationSubSheetEntity">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 20 23:16:43 CST 2017.
    -->
    update quotation_sub_sheet
    set PRODUCT_ID = #{productId,jdbcType=INTEGER},
      QUOTATION_SHEET_ID = #{quotationSheetId,jdbcType=INTEGER},
      USD_PRICE = #{usdPrice,jdbcType=DECIMAL},
      BUY_PRICE = #{buyPrice,jdbcType=DECIMAL},
      UNIT = #{unit,jdbcType=VARCHAR},
      WEIGHT = #{weight,jdbcType=INTEGER},
      VOLUME = #{volume,jdbcType=INTEGER},
      TOP = #{top,jdbcType=DECIMAL},
      BOTTOM = #{bottom,jdbcType=DECIMAL},
      HEIGHT = #{height,jdbcType=DECIMAL},
      PACKING = #{packing,jdbcType=VARCHAR},
      PACKING_RATE = #{packingRate,jdbcType=DECIMAL},
      NUMBER = #{number,jdbcType=INTEGER},
      PACK_NUM = #{packNum,jdbcType=INTEGER},
      TOTALCBM = #{totalcbm,jdbcType=DECIMAL},
      GW = #{gw,jdbcType=DECIMAL},
      TOTAL_GW = #{totalGw,jdbcType=DECIMAL}
    where QUOTATION_SUB_SHEET_ID = #{quotationSubSheet,jdbcType=INTEGER}
  </update>
</mapper>